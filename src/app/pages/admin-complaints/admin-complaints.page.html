<section class="flex flex-col gap-8">
  <header class="space-y-2">
    <p class="text-xs uppercase tracking-[0.3em] text-slate-400">Admin Console</p>
    <h1 class="text-3xl font-semibold text-white">All complaints</h1>
    <p class="text-sm text-slate-400">Review and update complaint status.</p>
  </header>

  <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-6 shadow-lg">
    <div class="flex items-center justify-between">
      <h2 class="text-lg font-semibold text-white">Complaints list</h2>
      <button
        type="button"
        class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-400 hover:text-slate-200"
        (click)="loadComplaints()"
      >
        Refresh
      </button>
    </div>

    <div class="mt-4 space-y-4">
      @if (listLoading()) {
        <p class="text-sm text-slate-400">Loading complaints...</p>
      } @else {
        @if (listError()) {
          <div
            class="rounded-lg border border-rose-500/40 bg-rose-500/10 px-3 py-2 text-sm text-rose-200"
            aria-live="polite"
          >
            {{ listError() }}
          </div>
        } @else {
          @if (complaints().length === 0) {
            <p class="text-sm text-slate-400">No complaints available.</p>
          } @else {
            @if (actionError()) {
              <div
                class="rounded-lg border border-rose-500/40 bg-rose-500/10 px-3 py-2 text-sm text-rose-200"
                aria-live="polite"
              >
                {{ actionError() }}
              </div>
            }
            <div class="space-y-3">
              @for (complaint of complaints(); track complaint.id) {
                <article class="rounded-xl border border-slate-800 bg-slate-950/70 p-4">
                  <div class="flex flex-col gap-3 md:flex-row md:items-start md:justify-between">
                    <div class="space-y-2">
                      <p class="text-sm text-slate-100">{{ complaint.description }}</p>
                      <div class="flex flex-wrap items-center gap-3 text-xs text-slate-400">
                        <span>Student: {{ complaint.userId }}</span>
                        <span>{{ complaint.createdAt | date: 'medium' }}</span>
                      </div>
                    </div>
                    <div class="flex items-center gap-3">
                      <span
                        class="rounded-full border px-2 py-0.5 text-xs font-semibold"
                        [class]="statusClass(complaint.status)"
                      >
                        {{ complaint.status }}
                      </span>
                      <button
                        type="button"
                        class="rounded-full border border-emerald-400/40 px-3 py-1 text-xs font-semibold text-emerald-200 transition hover:border-emerald-300 hover:text-emerald-100 disabled:cursor-not-allowed disabled:opacity-50"
                        [disabled]="isBusy(complaint.id) || complaint.status === 'approved'"
                        (click)="updateStatus(complaint, 'approved')"
                      >
                        Approve
                      </button>
                      <button
                        type="button"
                        class="rounded-full border border-rose-400/40 px-3 py-1 text-xs font-semibold text-rose-200 transition hover:border-rose-300 hover:text-rose-100 disabled:cursor-not-allowed disabled:opacity-50"
                        [disabled]="isBusy(complaint.id) || complaint.status === 'rejected'"
                        (click)="updateStatus(complaint, 'rejected')"
                      >
                        Reject
                      </button>
                    </div>
                  </div>
                </article>
              }
            </div>
          }
        }
      }
    </div>
  </div>
</section>
